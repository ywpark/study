# 입출력 방법

---

## 기본 정보

- `프로그램 입출력` 과 `인터럽트 기반 입출력`의 `공통점`
    - 입출력장치와 메모리 간의 데이터 이동은 CPU가 주도
    - 이동하는 데이터도 반드시 CPU를 거침

## 프로그램 입출력

- 프로그램 명령어로 입출력장치를 제어
- 입출력 명령어로 장치 컨트롤러와 상호작용
- 메모리에 저장된 정보를 하드디스크에 쓰기 과정
    1. CPU는 하드디스크 컨트롤러의 제어 레지스터에 쓰기 명령
    2. 하드디스크 컨트롤러는 하드디스크 상태 확인 → 상태 레지스터에 준비 완료 표시
    3. CPU는 상태 레지스터를 주기적으로 읽어보며 하드디스크의 준비 여부를 확인
    4. 하드디스크가 준비되었다면 백업할 메모리의 정보를 데이터 레지스터에 쓰기
    5. 쓰기 작업이 끝나지 않았다면 1번 부터 반복, 쓰기가 끝났다면 작업 종료
- CPU가 장치 컨트롤러의 레지스터 값을 읽고 씀으로써 작업이 이루어짐
    - 입출력 장치의 종류가 많은데 어떻게 CPU가 레지스터를 알고 값을 읽고 쓰는 것일까?
        - `메모리 맵 입출력 (Memory Mapped I/O)`
            - 메모리에 접근하기 위한 주소 공간과 입출력장치에 접근하기 위한 주소 공간을
            하나의 주소 공간으로 간주하는 방법
            - 메모리 접근 명령어 == 입출력장치 접근 명령어
            - 메모리 주소 공간이 축소됨
        - `고립형 입출력 (Isolated I/O)`
            - 메모리를 위한 주소 공간과 입출력장치를 위한 주소 공간을 분리하는 방법
            - 입출력 전용 명령어를 사용해야함
            - 메모리 주소 공간이 축소 되지 않음

## 인터럽트 기반 입출력

- 하드웨어 인터럽트는 장치 컨트롤러에 의해 발생
- 동시다발적으로 인터럽트가 발생하게 되면?
    - 발생한 순서대로 처리
    - 우선순위를 반영하여 처리
        - `PIC(Programmable Interrupt Controller)`
            - 여러 장치 컨트롤러에 연결
            - 장치 컨트롤러의 하드웨어 인터럽트의 우선순위를 판단
            - CPU에게 지금 처리해야 하는 인터럽트가 무엇인지 판단하는 하드웨어

## DMA (Direct Memory Access)

- CPU를 거치지 않고 입출력장치가 메모리에 직접적으로 접근하는 기능
- DMA 컨트롤러가 입출력 장치들과 데이터를 주고 받을 때 시스템 버스를 이용하게 되는데
시스템 버스는 동시에 사용 불가 ( CPU, DMA )
    - CPU가 시스템 버스를 이용하지 않을 때마다 조금씩 시스템 버스 이용
    - CPU가 일시적으로 시스템 버스를 이용하지 않도록 요청한 뒤 시스템 버스 이용

## 입출력 버스

- 장치 컨트롤러는 입출력 버스에 연결되어 있음
- 시스템 버스를 효율적으로 사용하기 위해 DMA 컨트롤러와 장치 컨트롤러들이 입출력 버스를
통해 시스템과 상호작용