# 명령어 사이클

---

## 명령어 사이클 (Instruction Cycle)

- 프로그램 명령어를 일정한 주기로 반복되며 실행
- `인출 사이클 (Fetch Cycle)`
    - 주 기억장치에서 명령어를 읽어오는 단계
    
    ```
    t0 : MAR <- PC
    t1 : MBR <- M[MAR], PC <- PC + 1
    t2 : IR <- MBR
    ```
    
    > `t0` : 프로그램 카운터(PC)에 저장된 명령어 주소를 CPU 내부 버스를 통해 메모리 주소 
            레지스터(MAR)로 보냄
    `t1` : MAR 가 지정하는 기억장치 주소로부터 명령어를 읽어서 데이터 버스를 통해 메모리 
            버퍼 레지스터(MBR)에 저장, 동시에 PC 가 1 증가
    `t2` : MBR에 저장된 명령어를 명령어 레지스터(IR)에 저장
    > 

- `실행 사이클 (Execution Cycle)`
    - 명령어를 실행하는 단계
    - CPU가 명령어 코드를 해석(decode)하고, 그 결과에 따라 필요한 연산들을 수행
    - 연산의 종류
        - 데이터 이동
            - `Load addr 명령어`
                - 기억장치에 저장되어 있는 데이터를 CPU 내부 누산기(AC)에 저장하는 명령
            
            ```
            t0 : MAR <- IR(addr)
            t1 : MBR <- M[MAR]
            t2 : AC <- MBR
            ```
            
            > `t0` : 명령어 레지스터(IR)에 있는 오퍼랜드를 메모리 주소 레지스터(MAR)에 저장
            `t1` : MAR가 지정하는 기억장치 주소로부터 데이터를 읽어서 메모리 버퍼
                레지스터(MBR)에 저장
            `t2` : MBR에 저장된 데이터를 누산기(AC)에 저장
            > 
        - 데이터 저장
            - `STA addr 명령어`
                - 누산기(AC)에 저장된 데이터를 기억장치에 저장하는 명령어
            
            ```
            t0 : MAR <- IR(addr)
            t1 : MBR <- AC
            t2 : M[MAR] <- MBR
            ```
            
            > `t0` : 명령어 레지스터(IR)에 있는 오퍼랜드를 메모리 주소 레지스터(MAR)에 저장
            `t1` : 누산기(AC)에 저장된 데이터를 메모리 버퍼 레지스터(MBR)에 저장
            `t2` : MBR에 저장된 데이터를 MAR가 지정하는 기억장치 주소에 저장
            > 
        - 데이터 처리
            - `ADD addr 명령어`
                - 기억장치에 저장된 데이터를 누산기(AC)에 저장된 값에 더하여 그 결과를 다시
                누산기에 저장하는 명령어
            
            ```
            t0 : MAR <- IR(addr)
            t1 : MBR <- M[MAR]
            t2 : AC <- AC + MBR
            ```
            
            > `t0` : 명령어 레지스터(IR)에 있는 오퍼랜드를 메모리 주소 레지스터(MAR)에 저장
            `t1` : 저장할 데이터를 MAR가 지정하는 기억장치 주소로부터 읽어서 메모리 버퍼
                    레지스터(MBR)에 저장
            `t2` : MBR에 저장된 데이터를 산술논리연산장치(ALU)에서 연산하여 그 결과값을
                    누산기(AC)에 저장
            > 
        - 프로그램 제어
            - `JUMP addr 명령어`
                - 오퍼랜드가 가리키는 주소의 명령어로 실행 순서를 변경하는 분기 명령어
            
            ```
            t0 : PC <- IR(addr)
            ```
            
            > `t0` : 명령어 레지스터(IR)에 저장된 오퍼랜드를 PC에 저장하여 명령어 순서를 변경
            > 

- 인출 ↔ 실행 사이클을 반복하며 동작함
    - 특정 상황에 아래와 같은 사이클을 추가적으로 거치는 경우가 있음
    - `간접 사이클`
        - 인출 사이클 이후에 메모리 접근이 추가적으로 필요한 경우에 발생
    - `인터럽트 사이클`
        - 실행 사이클 이후에 인터럽트가 발생된 경우에 발생